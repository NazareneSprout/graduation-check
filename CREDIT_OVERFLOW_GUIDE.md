# 학점 오버플로우 처리 가이드

## 개요

각 분류(전공필수, 전공선택, 교양 등)에서 **필요 학점을 초과하여 이수한 학점**들을 효율적으로 재분배하여 학점 낭비를 방지하는 시스템입니다.

## 🔄 오버플로우 재분배 알고리즘

### 1. **오버플로우 계산 대상 분류**

다음 분류들에서 넘치는 학점을 계산합니다:

- **전공필수** (majorRequired)
- **전공선택** (majorElective)
- **교양필수** (generalRequired)
- **교양선택** (generalElective)
- **소양** (liberalArts)
- **학부공통** (departmentCommon)
- **전공심화** (majorAdvanced)

### 2. **오버플로우 계산 공식**

```java
int overflow = Math.max(0, earned - required);
```

각 분류에서 (이수학점 - 필요학점)이 양수일 때 그 차이만큼 오버플로우로 계산됩니다.

## 📚 학번별 재분배 규칙

### **20-22학번 (구 교육과정)**

```
모든 오버플로우 학점 → 일반선택으로 이동
```

**재분배 대상:**
- 전공필수 오버플로우
- 전공선택 오버플로우
- 교양필수 오버플로우
- 교양선택 오버플로우
- 소양 오버플로우
- **학부공통 오버플로우**

**목적지:** `일반선택 (generalSelection)`

### **23-25학번 (신 교육과정)**

```
모든 오버플로우 학점 → 잔여학점으로 이동
```

**재분배 대상:**
- 전공필수 오버플로우
- 전공선택 오버플로우
- 교양필수 오버플로우
- 교양선택 오버플로우
- 소양 오버플로우
- **전공심화 오버플로우**

**목적지:** `잔여학점 (remainingCredits)`

## 🧹 원본 분류 정리

오버플로우를 이동한 후 원본 분류들은 **필요 학점으로 제한**됩니다:

```java
progress.majorRequired = new CategoryProgress(
    Math.min(earned, required),  // 이수학점을 필요학점으로 제한
    required                     // 필요학점은 그대로 유지
);
```

이렇게 하면 각 분류에서 **정확히 필요한 만큼**만 표시되고, 나머지는 적절한 목적지로 이동합니다.

## 📝 실제 처리 예시

### **IT학부 2023학번 학생 사례**

**입력:**
- 전공필수: 30학점 필요 → 35학점 이수 (5학점 오버)
- 전공선택: 24학점 필요 → 30학점 이수 (6학점 오버)
- 전공심화: 6학점 필요 → 9학점 이수 (3학점 오버)
- 교양필수: 12학점 필요 → 15학점 이수 (3학점 오버)
- 교양선택: 6학점 필요 → 6학점 이수 (0학점 오버)
- 소양: 4학점 필요 → 7학점 이수 (3학점 오버)

**오버플로우 계산:**
```
총 오버플로우 = 5 + 6 + 3 + 3 + 0 + 3 = 20학점
```

**재분배 결과:**
- 20학점이 **잔여학점**으로 이동
- 각 분류는 필요 학점으로 제한:
  - 전공필수: 30/30
  - 전공선택: 24/24
  - 전공심화: 6/6
  - 교양필수: 12/12
  - 교양선택: 6/6
  - 소양: 4/4
- 잔여학점: (원래 잔여학점 + 20)/필요잔여학점

### **IT학부 2020학번 학생 사례**

**입력:**
- 전공필수: 30학점 필요 → 33학점 이수 (3학점 오버)
- 전공선택: 21학점 필요 → 27학점 이수 (6학점 오버)
- 학부공통: 9학점 필요 → 12학점 이수 (3학점 오버)
- 교양필수: 12학점 필요 → 12학점 이수 (0학점 오버)
- 교양선택: 6학점 필요 → 9학점 이수 (3학점 오버)

**오버플로우 계산:**
```
총 오버플로우 = 3 + 6 + 3 + 0 + 3 = 15학점
```

**재분배 결과:**
- 15학점이 **일반선택**으로 이동
- 일반선택: (원래 일반선택 + 15)/필요일반선택

## 🎯 시스템의 장점

### 1. **학점 낭비 방지**
- 어떤 분류에서 많이 들어도 다른 곳에서 활용
- 모든 이수 학점이 졸업 요건에 반영

### 2. **유연한 수강 계획**
- 학생이 관심 분야에 집중해서 수강 가능
- 오버해도 다른 분류로 자동 인정

### 3. **정확한 진행률 표시**
- 각 분류는 정확히 필요한 만큼만 표시
- 전체 졸업 요건 달성률을 정확히 계산

### 4. **학번별 맞춤 처리**
- 구/신 교육과정의 차이를 정확히 반영
- 각 학번에 맞는 적절한 목적지로 이동

## 💡 사용자 안내 메시지

UI에서 각 분류마다 다음과 같은 안내를 표시합니다:

### **전공 관련 분류**
```
💡 전공필수는 반드시 필요한 학점입니다. 초과 이수한 학점은 잔여학점(23-25학번) 또는 일반선택(20-22학번)으로 인정됩니다.
```

```
💡 전공선택은 필요한 학점만큼 수강하세요. 초과 이수한 학점은 잔여학점(23-25학번) 또는 일반선택(20-22학번)으로 인정됩니다.
```

```
💡 전공심화는 필요한 학점만큼 수강하세요. 초과 이수한 학점은 잔여학점(23-25학번) 또는 일반선택(20-22학번)으로 인정됩니다.
```

### **학부공통 (20-22학번)**
```
💡 학부공통은 필요한 학점만큼 수강하세요. 초과 이수한 학점은 일반선택(20-22학번)으로 인정됩니다.
```

## 🔧 구현 세부사항

### **핵심 메서드**
- `calculateAndRedistributeOverflow()`: 오버플로우 계산 및 재분배
- 위치: `GraduationAnalysisResultActivity.java` 647번째 줄

### **처리 순서**
1. 각 분류별 오버플로우 계산
2. 학번 확인 (구/신 교육과정)
3. 총 오버플로우를 적절한 목적지로 이동
4. 원본 분류들을 필요 학점으로 제한
5. 로그 출력으로 처리 결과 확인

### **로그 메시지 예시**
```
넘침 학점 재분배 완료 - 총 20학점이 잔여학점으로 이동
넘침 학점 세부내역 - 전공필수:5, 전공선택:6, 교양필수:3, 교양선택:0, 소양:3
전공심화 넘침: 3학점
```

---

*이 가이드를 통해 학점 오버플로우 처리 시스템을 이해하고 유지보수할 수 있습니다.*